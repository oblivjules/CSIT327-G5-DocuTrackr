{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DocuTrackr - Request Document</title>
  <link rel="stylesheet" href="{% static 'css/style-request_form.css' %}">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="navbar">
    <div class="navbar-left">
      <img src="{% static 'images/logo.png' %}" alt="DocuTrackr Logo" class="logo" />
      <nav>
        <ul>
          <li><a href="{% url 'student-dashboard' %}">Home</a></li>
          <li><a href="#">About</a></li>
          <li><a href="{% url 'create_request' %}">Create Request</a></li>
          <li><a href="#">Track Documents</a></li>
        </ul>
      </nav>
    </div>

    <div class="navbar-right">
      <span class="user-name">{{ full_name }}</span>

      <div class="notification-icon">
        <img src="{% static 'images/bell.png' %}" alt="Notification Bell" />
      </div>

      <div class="profile-icon">
        <img src="{% static 'images/profile.png' %}" alt="User Profile" />
      </div>

      <a href="{% url 'student_logout' %}" class="logout-icon">
        <img src="{% static 'images/logout.png' %}" alt="Logout" />
      </a>
    </div>
  </header>

  <div class="container">
    <div class="request-form">
      <div class="form-header">
        <div class="form-icon">
          <img src="{% static 'images/folder.png' %}" alt="Request Icon" class="header-icon" />
        </div>
        <div>
          <h2>Request a New Document</h2>
          <p>Please fill out the form to request a document from the Registrar's Office.</p>
        </div>
      </div>

      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-grid">
          <div class="form-group">
            <label for="studentId" class="required">
              <img src="{% static 'images/user.png' %}" alt="Student ID Icon" class="input-icon" />
              Student ID
            </label>
            <input type="text" id="studentId" name="student_id" value="{{ student_id }}" readonly required>
          </div>

          <div class="form-group">
            <label for="studentName" class="required">
              <img src="{% static 'images/id-card.png' %}" alt="Student Name Icon" class="input-icon" />
              Student Name
            </label>
            <input type="text" id="studentName" name="student_name" value="{{ full_name }}" readonly required>
          </div>

          <div class="form-group">
            <label for="docType" class="required">
              <img src="{% static 'images/doc.png' %}" alt="Document Type Icon" class="input-icon" />
              Select Document Type
            </label>
            <select id="docType" name="document_type" required>
              <option value="">-- Select Document Type --</option>
              <option value="report_card" {% if document_type == 'report_card' %}selected{% endif %}>Report Card / Form 138</option>
              <option value="tor" {% if document_type == 'tor' %}selected{% endif %}>Transcript of Records (TOR)</option>
              <option value="good_moral" {% if document_type == 'good_moral' %}selected{% endif %}>Certificate of Good Moral Character</option>
              <option value="coe" {% if document_type == 'coe' %}selected{% endif %}>Certificate of Enrollment (COE)</option>
              <option value="diploma" {% if document_type == 'diploma' %}selected{% endif %}>Diploma / Graduation Certificate</option>
              <option value="transfer_credential" {% if document_type == 'transfer_credential' %}selected{% endif %}>Transfer Credential / Honorable Dismissal</option>
              <option value="birth_certificate" {% if document_type == 'birth_certificate' %}selected{% endif %}>PSA Birth Certificate</option>
              <option value="student_clearance" {% if document_type == 'student_clearance' %}selected{% endif %}>Student Clearance / Certification</option>
            </select>
          </div>

          <div class="form-group">
            <label for="dateNeeded">
              <img src="{% static 'images/datepicker.png' %}" alt="Date Picker Icon" class="input-icon" />
              Date Needed By
            </label>
            <input type="date" id="dateNeeded" name="date_needed" value="{{ date_needed|default:'' }}" required>
          </div>

          <div class="form-group">
            <label for="copies" class="required">
              <img src="{% static 'images/copy.png' %}" alt="Copies Icon" class="input-icon" />
              Number of Copies
            </label>
            <input type="number" id="copies" name="copies" min="1" value="{{ copies|default:'' }}" placeholder="1" required>
          </div>

          <div class="file-upload">
            <div class="upload-icon">
                <img src="{% static 'images/upload.png' %}" alt="Upload Icon" />
            </div>
            <p class="upload-title">Proof of Payment Upload</p>
            <p class="upload-subtitle">Upload your payment receipt here</p>
            <input type="file" id="fileInput" name="proof_of_payment" accept=".png,.jpg,.jpeg,.svg,.webp">
            <label for="fileInput" class="file-label">Choose File</label>
            <p class="upload-info">Supported formats: PNG, JPG, JPEG, SVG, WEBP</p>
            <p class="form-error" style="color:red; font-weight:bold;"></p>
        </div>

        {% if success %}
        <script>
          window.addEventListener("load", () => {
            setTimeout(() => {
              alert("{{ success|escapejs }}");
            }, 100);
          });
        </script>
        {% endif %}

          <div class="submit-btn">
            <button type="submit">
              Submit Request
              <img src="{% static 'images/submit.png' %}" alt="Submit Icon" class="submit-icon" />
            </button>
          </div>
        </div>
      </form>
    </div>

    <div class="history">
      <div class="history-header">
        <img src="{% static 'images/history.png' %}" alt="History Icon" class="history-icon" />
        <h3>Request History</h3>
      </div>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Request ID</th>
              <th>Document</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="request-id">#001</span></td>
              <td>Form 137</td>
              <td><span class="status-badge status-completed">Completed</span></td>
            </tr>
            <tr>
              <td><span class="request-id">#002</span></td>
              <td>COE</td>
              <td><span class="status-badge status-processing">Processing</span></td>
            </tr>
            <tr>
              <td><span class="request-id">#003</span></td>
              <td>Transcript of Records</td>
              <td><span class="status-badge status-pending">Pending</span></td>
            </tr>
            <tr>
              <td><span class="request-id">#004</span></td>
              <td>CGMC</td>
              <td><span class="status-badge status-completed">Completed</span></td>
            </tr>
            <tr>
              <td><span class="request-id">#005</span></td>
              <td>CGMC</td>
              <td><span class="status-badge status-processing">Processing</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
<script src="{% static 'js/request-form.js' %}"></script>
</html>
